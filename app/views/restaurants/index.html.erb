
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <title>Google Maps Multiple Markers</title>
  <script src="http://maps.google.com/maps/api/js?sensor=false"
          type="text/javascript"></script>
</head>

<div class="centered" id="map" style="width: 500px; height: 400px;"></div>

<script type="text/javascript">
//    var locations = [
//        ['Bondi Beach', -33.890542, 151.274856, 4],
//        ['Coogee Beach', -33.923036, 151.259052, 5],
//        ['Cronulla Beach', -34.028249, 151.157507, 3],
//        ['Manly Beach', -33.80010128657071, 151.28747820854187, 2],
//        ['Maroubra Beach', -33.950198, 151.259302, 1]
//    ];
////
//var locations = [];
//locations.push()

//    var locations = [['lalala', <%=  @restaurants.first.latitude %>, <%=  @restaurants.first.longitude %>,1]]
    var locations = <%= raw @locations.as_json %>
    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 17,
        center: new google.maps.LatLng(<%= @lat_ar.first %>, <%= @long_ar.first %>),
        mapTypeId: google.maps.MapTypeId.ROADMAP
    });

    var infowindow = new google.maps.InfoWindow();

    var marker, i;

    for (i = 0; i < locations.length; i++) {
        marker = new google.maps.Marker({
            position: new google.maps.LatLng(locations[i][1], locations[i][2]),
            map: map
        });

        google.maps.event.addListener(marker, 'click', (function(marker, i) {
            return function() {
                infowindow.setContent(locations[i][0]);
                infowindow.open(map, marker);
            }
        })(marker, i));
    }
</script>






    <h1>Nearby Restaurants</h1>
    <table>
      <thead>
      <tr>
        <th>Id</th>
        <th>Address</th>
        <th>Name</th>
        <th>Photo</th>
        <th>City</th>
        <th>State</th>
        <th>URL</th>
        <th>ReviewCount</th>
        <th>Stars</th>
        <th>Longitude</th>
        <th>Latitude</th>
      </tr>
      </thead>
      <tbody>
      <% @restaurants.each do |near| %>
          <!--<%= image_tag "http://maps.google.com/maps/api/staticmap?size=450x300&sensor=false&zoom=16&markers=#{near.latitude}%2C#{near.longitude}" %>-->
          <tr>
            <td><%= near.id %></td>
            <td><%= near.address %></td>
            <td><%= near.businessName %></td>
            <td><%= link_to(near.photoURL, near.photoURL)%></td>
            <td><%= near.city %></td>
            <td><%= near.state %></td>
            <td><%= link_to(near.url, near.url) %></td>
            <td><%= near.reviewCount %></td>
            <td><%= near.stars %></td>
            <td><%= near.longitude %></td>
            <td><%= near.latitude %></td>
          </tr>
      <% end %>
      </tbody>
    </table>
    <!--<h1>Import a CSV File</h1>
  <%= form_tag import_restaurants_path, multipart: true do %>
        <%= file_field_tag :file %>
        <%= submit_tag "Import CSV" %> -->
    <% end %>
